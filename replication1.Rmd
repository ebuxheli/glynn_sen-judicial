---
title: "Daughters"
author: "Enxhi Buxheli and John LaVelle"
date: "2/2/2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

# Attaching necessary libraries
library(tidyverse)
library(dplyr)
library(janitor)
library(knitr)
```

```{r}
# Loading in the data
case_data  <- read_csv("dataverse_files/glynn_sen_daughters_by_case_1.csv") %>% clean_names()
judge_data <- read_csv("dataverse_files/glynn_sen_daughters_by_judge.csv") %>% clean_names()

# Table 1: Number of Children and Girls for U.S. Courts of Appeals Judges 
#          Participating in Gender-Related Cases, 1996-2002
# Here we are keeping the # of children, # of girls, & party affiliation and
# building a count table. Additionally, here the party name is recoded to be
# more friendly to a reader of the table ("Republicans" and "Democrats")
t1 <- select(judge_data,
              child, girls, republican) %>% 
  filter(child < 10, girls < 10) %>% 
  mutate(party = ifelse(1 == republican, "Republicans", "Democrats"))

# Number of Children portion of the table
t1 %>% 
  count(party, child) %>% 
  spread(child, n) %>% 
  mutate_all(funs(replace(., is.na(.), "-"))) %>% 
  kable(caption = "Number of Children and Girls for U.S. Courts of Appeals 
        Judges Participating in Gender-Related Cases, 1996-2002")

# Number of Girls portion of the table
t1 %>% 
  count(party, girls) %>% 
  spread(girls, n) %>% 
  mutate_all(funs(replace(., is.na(.), "-")))
```

```{r}
# Table 2

proportion_equals_x <- function(data, x, geq = FALSE) {
  if(geq) {
    ct <- data %>%
    filter(child >= x) %>% 
    count() / length(data)
  }
  else {
    ct <- data %>% 
    filter(child == x) %>% 
    count()
  }
  ct / count(data)
}

t2 <- select(judge_data, republican, woman, race, yearb, child, girls) %>% 
  filter(!is.na(girls) , !is.na(child) ) %>% 
  mutate(white = ifelse(race == 1, 1, 0))

t2 %>% 
  summarize(
    mean_child = mean(child),
    mean_girls = mean(girls),
    mean_yearb = mean(yearb, na.rm = TRUE)
  )

proportion = vector()

for(i in 1:7) {
  proportion[1][i] <- 
    t2 %>% 
    proportion_equals_x(i-1)
}

proportion[1][7] <- t2 %>% proportion_equals_x(6, geq = TRUE)

proportion_female <- t2 %>% 
  filter(woman == 1) %>% 
  count() / count(t2)

# gt(data.frame(proportion, row.names = c(
# 	"Proportion who have 0 children","1 children",
# 	"2 children", "3 children",
# 	"4 children", "5 Children", "6 Children or More")))



```
```

t2 %>% 
  group_by(woman) %>% 
  summarize(
    mean_child = mean(child, na.rm = TRUE),
    mean_girls = mean(girls, na.rm = TRUE),
    mean_yearb = mean(yearb, na.rm = TRUE)
  )

t2 %>% 
  group_by(republican) %>% 
  summarize(
    mean_child = mean(child, na.rm = TRUE),
    mean_girls = mean(girls, na.rm = TRUE),
    mean_yearb = mean(yearb, na.rm = TRUE)
  ) 



kable(t2, caption = "Demographics of U.S. Courts of Appeals Judges Who Voted on Gender-Related Cases, 1996-2002")

```

